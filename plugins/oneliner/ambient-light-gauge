#!/usr/bin/env zsh

local npm_bin=$(npm -g bin)

# require('gradient-string').pastel('■'.repeat(256)).split(/\b(?<=39m)/)
ambient-light -w | node -e "
var G = require('${npm_bin:h}/lib/node_modules/npm/node_modules/gauge')
var T = require('${npm_bin:h}/lib/node_modules/npm/node_modules/gauge/lib/themes')
var t = T.newTheme(T({hasUnicode: true, hasColor: true}), {
  preProgressbar: '',
  postProgressbar: '',
  activityIndicatorTheme: [
    '\x1B[38;2;116;235;213m■\x1B[39m',
    '\x1B[38;2;116;235;216m■\x1B[39m',
    '\x1B[38;2;116;235;219m■\x1B[39m',
    '\x1B[38;2;116;235;221m■\x1B[39m',
    '\x1B[38;2;116;235;224m■\x1B[39m',
    '\x1B[38;2;116;235;227m■\x1B[39m',
    '\x1B[38;2;116;235;230m■\x1B[39m',
    '\x1B[38;2;116;235;233m■\x1B[39m',
    '\x1B[38;2;116;235;235m■\x1B[39m',
    '\x1B[38;2;116;232;235m■\x1B[39m',
    '\x1B[38;2;116;229;235m■\x1B[39m',
    '\x1B[38;2;116;226;235m■\x1B[39m',
    '\x1B[38;2;116;223;235m■\x1B[39m',
    '\x1B[38;2;116;221;235m■\x1B[39m',
    '\x1B[38;2;116;218;235m■\x1B[39m',
    '\x1B[38;2;116;215;235m■\x1B[39m',
    '\x1B[38;2;116;212;235m■\x1B[39m',
    '\x1B[38;2;116;210;235m■\x1B[39m',
    '\x1B[38;2;116;207;235m■\x1B[39m',
    '\x1B[38;2;116;204;235m■\x1B[39m',
    '\x1B[38;2;116;201;235m■\x1B[39m',
    '\x1B[38;2;116;198;235m■\x1B[39m',
    '\x1B[38;2;116;196;235m■\x1B[39m',
    '\x1B[38;2;116;193;235m■\x1B[39m',
    '\x1B[38;2;116;190;235m■\x1B[39m',
    '\x1B[38;2;116;187;235m■\x1B[39m',
    '\x1B[38;2;116;184;235m■\x1B[39m',
    '\x1B[38;2;116;182;235m■\x1B[39m',
    '\x1B[38;2;116;179;235m■\x1B[39m',
    '\x1B[38;2;116;176;235m■\x1B[39m',
    '\x1B[38;2;116;173;235m■\x1B[39m',
    '\x1B[38;2;116;170;235m■\x1B[39m',
    '\x1B[38;2;116;168;235m■\x1B[39m',
    '\x1B[38;2;116;165;235m■\x1B[39m',
    '\x1B[38;2;116;162;235m■\x1B[39m',
    '\x1B[38;2;116;159;235m■\x1B[39m',
    '\x1B[38;2;116;156;235m■\x1B[39m',
    '\x1B[38;2;116;154;235m■\x1B[39m',
    '\x1B[38;2;116;151;235m■\x1B[39m',
    '\x1B[38;2;116;148;235m■\x1B[39m',
    '\x1B[38;2;116;145;235m■\x1B[39m',
    '\x1B[38;2;116;142;235m■\x1B[39m',
    '\x1B[38;2;116;140;235m■\x1B[39m',
    '\x1B[38;2;116;137;235m■\x1B[39m',
    '\x1B[38;2;116;134;235m■\x1B[39m',
    '\x1B[38;2;116;131;235m■\x1B[39m',
    '\x1B[38;2;116;128;235m■\x1B[39m',
    '\x1B[38;2;116;126;235m■\x1B[39m',
    '\x1B[38;2;116;123;235m■\x1B[39m',
    '\x1B[38;2;116;120;235m■\x1B[39m',
    '\x1B[38;2;116;117;235m■\x1B[39m',
    '\x1B[38;2;118;116;235m■\x1B[39m',
    '\x1B[38;2;120;116;235m■\x1B[39m',
    '\x1B[38;2;123;116;235m■\x1B[39m',
    '\x1B[38;2;126;116;235m■\x1B[39m',
    '\x1B[38;2;129;116;235m■\x1B[39m',
    '\x1B[38;2;132;116;235m■\x1B[39m',
    '\x1B[38;2;134;116;235m■\x1B[39m',
    '\x1B[38;2;137;116;235m■\x1B[39m',
    '\x1B[38;2;140;116;235m■\x1B[39m',
    '\x1B[38;2;143;116;235m■\x1B[39m',
    '\x1B[38;2;146;116;235m■\x1B[39m',
    '\x1B[38;2;148;116;235m■\x1B[39m',
    '\x1B[38;2;151;116;235m■\x1B[39m',
    '\x1B[38;2;154;116;235m■\x1B[39m',
    '\x1B[38;2;157;116;235m■\x1B[39m',
    '\x1B[38;2;160;116;235m■\x1B[39m',
    '\x1B[38;2;162;116;235m■\x1B[39m',
    '\x1B[38;2;165;116;235m■\x1B[39m',
    '\x1B[38;2;168;116;235m■\x1B[39m',
    '\x1B[38;2;171;116;235m■\x1B[39m',
    '\x1B[38;2;174;116;235m■\x1B[39m',
    '\x1B[38;2;177;116;235m■\x1B[39m',
    '\x1B[38;2;179;116;235m■\x1B[39m',
    '\x1B[38;2;182;116;235m■\x1B[39m',
    '\x1B[38;2;185;116;235m■\x1B[39m',
    '\x1B[38;2;188;116;235m■\x1B[39m',
    '\x1B[38;2;191;116;235m■\x1B[39m',
    '\x1B[38;2;193;116;235m■\x1B[39m',
    '\x1B[38;2;196;116;235m■\x1B[39m',
    '\x1B[38;2;199;116;235m■\x1B[39m',
    '\x1B[38;2;202;116;235m■\x1B[39m',
    '\x1B[38;2;205;116;235m■\x1B[39m',
    '\x1B[38;2;207;116;235m■\x1B[39m',
    '\x1B[38;2;210;116;235m■\x1B[39m',
    '\x1B[38;2;213;116;235m■\x1B[39m',
    '\x1B[38;2;216;116;235m■\x1B[39m',
    '\x1B[38;2;219;116;235m■\x1B[39m',
    '\x1B[38;2;221;116;235m■\x1B[39m',
    '\x1B[38;2;224;116;235m■\x1B[39m',
    '\x1B[38;2;227;116;235m■\x1B[39m',
    '\x1B[38;2;230;116;235m■\x1B[39m',
    '\x1B[38;2;233;116;235m■\x1B[39m',
    '\x1B[38;2;235;116;235m■\x1B[39m',
    '\x1B[38;2;235;116;232m■\x1B[39m',
    '\x1B[38;2;235;116;230m■\x1B[39m',
    '\x1B[38;2;235;116;227m■\x1B[39m',
    '\x1B[38;2;235;116;224m■\x1B[39m',
    '\x1B[38;2;235;116;221m■\x1B[39m',
    '\x1B[38;2;235;116;218m■\x1B[39m',
    '\x1B[38;2;235;116;216m■\x1B[39m',
    '\x1B[38;2;235;116;213m■\x1B[39m',
    '\x1B[38;2;235;116;210m■\x1B[39m',
    '\x1B[38;2;235;116;207m■\x1B[39m',
    '\x1B[38;2;235;116;204m■\x1B[39m',
    '\x1B[38;2;235;116;202m■\x1B[39m',
    '\x1B[38;2;235;116;199m■\x1B[39m',
    '\x1B[38;2;235;116;196m■\x1B[39m',
    '\x1B[38;2;235;116;193m■\x1B[39m',
    '\x1B[38;2;235;116;190m■\x1B[39m',
    '\x1B[38;2;235;116;188m■\x1B[39m',
    '\x1B[38;2;235;116;185m■\x1B[39m',
    '\x1B[38;2;235;116;182m■\x1B[39m',
    '\x1B[38;2;235;116;179m■\x1B[39m',
    '\x1B[38;2;235;116;176m■\x1B[39m',
    '\x1B[38;2;235;116;174m■\x1B[39m',
    '\x1B[38;2;235;116;171m■\x1B[39m',
    '\x1B[38;2;235;116;168m■\x1B[39m',
    '\x1B[38;2;235;116;165m■\x1B[39m',
    '\x1B[38;2;235;116;162m■\x1B[39m',
    '\x1B[38;2;235;116;160m■\x1B[39m',
    '\x1B[38;2;235;116;157m■\x1B[39m',
    '\x1B[38;2;235;116;154m■\x1B[39m',
    '\x1B[38;2;235;116;151m■\x1B[39m',
    '\x1B[38;2;235;116;148m■\x1B[39m',
    '\x1B[38;2;235;116;146m■\x1B[39m',
    '\x1B[38;2;235;116;143m■\x1B[39m',
    '\x1B[38;2;235;116;140m■\x1B[39m',
    '\x1B[38;2;235;116;137m■\x1B[39m',
    '\x1B[38;2;235;116;134m■\x1B[39m',
    '\x1B[38;2;235;116;131m■\x1B[39m',
    '\x1B[38;2;235;116;129m■\x1B[39m',
    '\x1B[38;2;235;116;126m■\x1B[39m',
    '\x1B[38;2;236;116;123m■\x1B[39m',
    '\x1B[38;2;236;116;120m■\x1B[39m',
    '\x1B[38;2;236;116;117m■\x1B[39m',
    '\x1B[38;2;236;117;116m■\x1B[39m',
    '\x1B[38;2;236;120;116m■\x1B[39m',
    '\x1B[38;2;236;123;116m■\x1B[39m',
    '\x1B[38;2;236;126;116m■\x1B[39m',
    '\x1B[38;2;236;129;116m■\x1B[39m',
    '\x1B[38;2;236;131;116m■\x1B[39m',
    '\x1B[38;2;236;134;116m■\x1B[39m',
    '\x1B[38;2;236;137;116m■\x1B[39m',
    '\x1B[38;2;236;140;116m■\x1B[39m',
    '\x1B[38;2;236;143;116m■\x1B[39m',
    '\x1B[38;2;236;145;116m■\x1B[39m',
    '\x1B[38;2;236;148;116m■\x1B[39m',
    '\x1B[38;2;236;151;116m■\x1B[39m',
    '\x1B[38;2;236;154;116m■\x1B[39m',
    '\x1B[38;2;236;157;116m■\x1B[39m',
    '\x1B[38;2;236;160;116m■\x1B[39m',
    '\x1B[38;2;236;162;116m■\x1B[39m',
    '\x1B[38;2;236;165;116m■\x1B[39m',
    '\x1B[38;2;236;168;116m■\x1B[39m',
    '\x1B[38;2;236;171;116m■\x1B[39m',
    '\x1B[38;2;236;174;116m■\x1B[39m',
    '\x1B[38;2;236;176;116m■\x1B[39m',
    '\x1B[38;2;236;179;116m■\x1B[39m',
    '\x1B[38;2;236;182;116m■\x1B[39m',
    '\x1B[38;2;236;185;116m■\x1B[39m',
    '\x1B[38;2;236;188;116m■\x1B[39m',
    '\x1B[38;2;236;190;116m■\x1B[39m',
    '\x1B[38;2;236;193;116m■\x1B[39m',
    '\x1B[38;2;236;196;116m■\x1B[39m',
    '\x1B[38;2;236;199;116m■\x1B[39m',
    '\x1B[38;2;236;202;116m■\x1B[39m',
    '\x1B[38;2;236;205;116m■\x1B[39m',
    '\x1B[38;2;236;207;116m■\x1B[39m',
    '\x1B[38;2;236;210;116m■\x1B[39m',
    '\x1B[38;2;236;213;116m■\x1B[39m',
    '\x1B[38;2;236;216;116m■\x1B[39m',
    '\x1B[38;2;236;219;116m■\x1B[39m',
    '\x1B[38;2;236;221;116m■\x1B[39m',
    '\x1B[38;2;236;224;116m■\x1B[39m',
    '\x1B[38;2;236;227;116m■\x1B[39m',
    '\x1B[38;2;236;230;116m■\x1B[39m',
    '\x1B[38;2;236;233;116m■\x1B[39m',
    '\x1B[38;2;236;236;116m■\x1B[39m',
    '\x1B[38;2;233;236;116m■\x1B[39m',
    '\x1B[38;2;230;236;116m■\x1B[39m',
    '\x1B[38;2;227;236;116m■\x1B[39m',
    '\x1B[38;2;225;236;116m■\x1B[39m',
    '\x1B[38;2;222;236;116m■\x1B[39m',
    '\x1B[38;2;219;236;116m■\x1B[39m',
    '\x1B[38;2;216;236;116m■\x1B[39m',
    '\x1B[38;2;213;236;116m■\x1B[39m',
    '\x1B[38;2;211;236;116m■\x1B[39m',
    '\x1B[38;2;208;236;116m■\x1B[39m',
    '\x1B[38;2;205;236;116m■\x1B[39m',
    '\x1B[38;2;202;236;116m■\x1B[39m',
    '\x1B[38;2;199;236;116m■\x1B[39m',
    '\x1B[38;2;197;236;116m■\x1B[39m',
    '\x1B[38;2;194;236;116m■\x1B[39m',
    '\x1B[38;2;191;236;116m■\x1B[39m',
    '\x1B[38;2;188;236;116m■\x1B[39m',
    '\x1B[38;2;185;236;116m■\x1B[39m',
    '\x1B[38;2;182;236;116m■\x1B[39m',
    '\x1B[38;2;180;236;116m■\x1B[39m',
    '\x1B[38;2;177;236;116m■\x1B[39m',
    '\x1B[38;2;174;236;116m■\x1B[39m',
    '\x1B[38;2;171;236;116m■\x1B[39m',
    '\x1B[38;2;168;236;116m■\x1B[39m',
    '\x1B[38;2;166;236;116m■\x1B[39m',
    '\x1B[38;2;163;236;116m■\x1B[39m',
    '\x1B[38;2;160;236;116m■\x1B[39m',
    '\x1B[38;2;157;236;116m■\x1B[39m',
    '\x1B[38;2;154;236;116m■\x1B[39m',
    '\x1B[38;2;152;236;116m■\x1B[39m',
    '\x1B[38;2;149;236;116m■\x1B[39m',
    '\x1B[38;2;146;236;116m■\x1B[39m',
    '\x1B[38;2;143;236;116m■\x1B[39m',
    '\x1B[38;2;140;236;116m■\x1B[39m',
    '\x1B[38;2;137;236;116m■\x1B[39m',
    '\x1B[38;2;135;236;116m■\x1B[39m',
    '\x1B[38;2;132;236;116m■\x1B[39m',
    '\x1B[38;2;129;236;116m■\x1B[39m',
    '\x1B[38;2;126;236;116m■\x1B[39m',
    '\x1B[38;2;123;236;116m■\x1B[39m',
    '\x1B[38;2;121;236;116m■\x1B[39m',
    '\x1B[38;2;118;236;116m■\x1B[39m',
    '\x1B[38;2;116;236;117m■\x1B[39m',
    '\x1B[38;2;116;236;120m■\x1B[39m',
    '\x1B[38;2;116;236;123m■\x1B[39m',
    '\x1B[38;2;116;236;126m■\x1B[39m',
    '\x1B[38;2;116;236;128m■\x1B[39m',
    '\x1B[38;2;116;236;131m■\x1B[39m',
    '\x1B[38;2;116;236;134m■\x1B[39m',
    '\x1B[38;2;116;236;137m■\x1B[39m',
    '\x1B[38;2;116;236;140m■\x1B[39m',
    '\x1B[38;2;116;236;142m■\x1B[39m',
    '\x1B[38;2;116;236;145m■\x1B[39m',
    '\x1B[38;2;116;236;148m■\x1B[39m',
    '\x1B[38;2;116;236;151m■\x1B[39m',
    '\x1B[38;2;116;236;154m■\x1B[39m',
    '\x1B[38;2;116;236;157m■\x1B[39m',
    '\x1B[38;2;116;236;159m■\x1B[39m',
    '\x1B[38;2;116;236;162m■\x1B[39m',
    '\x1B[38;2;116;236;165m■\x1B[39m',
    '\x1B[38;2;116;236;168m■\x1B[39m',
    '\x1B[38;2;116;236;171m■\x1B[39m',
    '\x1B[38;2;116;236;173m■\x1B[39m',
    '\x1B[38;2;116;236;176m■\x1B[39m',
    '\x1B[38;2;116;236;179m■\x1B[39m',
    '\x1B[38;2;116;236;182m■\x1B[39m',
    '\x1B[38;2;116;236;185m■\x1B[39m',
    '\x1B[38;2;116;236;188m■\x1B[39m',
    '\x1B[38;2;116;236;190m■\x1B[39m',
    '\x1B[38;2;116;236;193m■\x1B[39m',
    '\x1B[38;2;116;236;196m■\x1B[39m',
    '\x1B[38;2;116;236;199m■\x1B[39m',
    '\x1B[38;2;116;236;202m■\x1B[39m',
    '\x1B[38;2;116;236;205m■\x1B[39m',
    '\x1B[38;2;116;236;207m■\x1B[39m',
    '\x1B[38;2;116;236;210m■\x1B[39m',
    '\x1B[38;2;116;236;213m■\x1B[39m'
  ]
})
var g = new G({theme: t});
var n, max=200;
process.stdin.on('data', (d) => {
  g.pulse();
  var s = d.toString('utf-8').trim();
  if (s) n = Number(s);
  if (n > max) max = n;
  g.show('brightness: ' + n.toFixed(1) + ' lux', Math.sqrt(n) / Math.sqrt(max))
});
process.stdin.on('end', () => {
  g.hide();
  console.log(n.toFixed(1))
})
"
